"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@babel/runtime/helpers/extends"),n=require("@react-three/fiber"),t=require("lodash.omit"),r=require("lodash.pick"),a=require("react"),u=require("three"),o=require("three-stdlib");function l(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function s(e){if(e&&e.__esModule)return e;var n=Object.create(null);return e&&Object.keys(e).forEach((function(t){if("default"!==t){var r=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(n,t,r.get?r:{enumerable:!0,get:function(){return e[t]}})}})),n.default=e,Object.freeze(n)}var i=l(e),c=l(t),d=l(r),f=s(a),v=s(u);const m=f.forwardRef((({children:e,domElement:t,onChange:r,onMouseDown:a,onMouseUp:u,onObjectChange:l,object:s,...m},h)=>{const E=["enabled","axis","mode","translationSnap","rotationSnap","scaleSnap","space","size","showX","showY","showZ"],{camera:b,...g}=m,L=d.default(g,E),p=c.default(g,E),j=n.useThree((e=>e.controls)),O=n.useThree((e=>e.gl)),w=n.useThree((e=>e.events)),q=n.useThree((e=>e.camera)),T=n.useThree((e=>e.invalidate)),y=b||q,C=t||w.connected||O.domElement,D=f.useMemo((()=>new o.TransformControls(y,C)),[y,C]),M=f.useRef();return f.useLayoutEffect((()=>(s?D.attach(s instanceof v.Object3D?s:s.current):M.current instanceof v.Object3D&&D.attach(M.current),()=>{D.detach()})),[s,e,D]),f.useEffect((()=>{if(j){const e=e=>j.enabled=!e.value;return D.addEventListener("dragging-changed",e),()=>D.removeEventListener("dragging-changed",e)}}),[D,j]),f.useEffect((()=>{const e=e=>{T(),r&&r(e)};return null==D||null==D.addEventListener||D.addEventListener("change",e),a&&(null==D||null==D.addEventListener||D.addEventListener("mouseDown",a)),u&&(null==D||null==D.addEventListener||D.addEventListener("mouseUp",u)),l&&(null==D||null==D.addEventListener||D.addEventListener("objectChange",l)),()=>{null==D||null==D.removeEventListener||D.removeEventListener("change",e),a&&(null==D||null==D.removeEventListener||D.removeEventListener("mouseDown",a)),u&&(null==D||null==D.removeEventListener||D.removeEventListener("mouseUp",u)),l&&(null==D||null==D.removeEventListener||D.removeEventListener("objectChange",l))}}),[r,a,u,l,D,T]),D?f.createElement(f.Fragment,null,f.createElement("primitive",i.default({ref:h,object:D},L)),f.createElement("group",i.default({ref:M},p),e)):null}));exports.TransformControls=m;
